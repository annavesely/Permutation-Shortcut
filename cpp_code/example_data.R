D <- matrix(c(
  0.0000000,  0.0000000,  0.000000,   0.000000,   0.00000,
 -6.0332299, -7.9891551, -8.837963, -16.621151, -28.31715,
 -5.2878397, -5.0247784, -9.041290, -13.611330, -27.72480,
  2.4310691, -8.2525989, -9.144724,  13.633185, -27.34498,
 -5.6346215, -6.4902400, -8.381926,  -9.234057, -28.19478,
 -6.0754529, -6.5068208, -9.381463, -16.641632, -26.59048,
 -4.5938194, -3.3576824, -8.336441, -14.857562, -10.74028,
 -5.8541593, -9.0718904, -5.329174,   9.443486, -26.64566,
 -0.2822065, -0.8926541, -4.981715, -16.311751, -25.70714,
  2.7240618, 14.7005331, -6.993044, -16.647395, -27.27427
), ncol=5, byrow=T)


R <- matrix(c(
  0.0000000,  0.0000000,  0.000000,   0.000000,   0.00000,
 -6.0332299, -7.9891551, -8.837963, -16.621151, -28.31715,
 -5.0247784, -5.2878397, -9.041290, -13.611330, -27.72480,
 13.6331852,  2.4310691, -8.252599,  -9.144724, -27.34498,
 -5.6346215, -6.4902400, -8.381926,  -9.234057, -28.19478,
 -6.0754529, -6.5068208, -9.381463, -16.641632, -26.59048,
 -3.3576824, -4.5938194, -8.336441, -10.740281, -14.85756,
  9.4434861, -5.3291744, -5.854159,  -9.071890, -26.64566,
 -0.2822065, -0.8926541, -4.981715, -16.311751, -25.70714,
 14.7005331,  2.7240618, -6.993044, -16.647395, -27.27427
), ncol=5, byrow=T)


I <- matrix(c(
    1,    2,    5,    3,    4,
    4,    3,    5,    2,    1,
    3,    4,    5,    2,    1,
    2,    4,    3,    5,    1,
    4,    3,    5,    2,    1,
    4,    3,    5,    2,    1,
    3,    4,    5,    1,    2,
    2,    5,    4,    3,    1,
    4,    3,    5,    2,    1,
    3,    4,    5,    2,    1
), ncol=5, byrow=T)


S <- c(5)
alpha <- 0.20
n_max <-20
from_low <- F
first_rem <- T

# S=5
# S=

# F, T
# F, F
# T, T
# T, F

C_out <- ctrp_test(S, D, R, I, alpha, n_max, T, F)
C_out


# ------------------------------------------------------------------------- #


k <- 8
m <- 4
B <- 10
from_low <- F
first_rem <- T
n_max <- 20


ind_0 <- c(1,2)


D_0 <- matrix(c(
  0.0000000,  0.0000000,   0.000000,   0.00000,
 -6.0332299, -7.9891551, -16.621151, -28.31715,
 -5.2878397, -5.0247784, -13.611330, -27.72480,
  2.4310691, -8.2525989,  13.633185, -27.34498,
 -5.6346215, -6.4902400,  -9.234057, -28.19478,
 -6.0754529, -6.5068208, -16.641632, -26.59048,
 -4.5938194, -3.3576824, -14.857562, -10.74028,
 -5.8541593, -9.0718904,   9.443486, -26.64566,
 -0.2822065, -0.8926541, -16.311751, -25.70714,
  2.7240618, 14.7005331, -16.647395, -27.27427
), ncol=4, byrow=T)


R_0 <- matrix(c(
  0.0000000,  0.0000000,   0.000000,   0.00000,
 -6.0332299, -7.9891551, -16.621151, -28.31715,
 -5.0247784, -5.2878397, -13.611330, -27.72480,
 13.6331852,  2.4310691,  -8.252599, -27.34498,
 -5.6346215, -6.4902400,  -9.234057, -28.19478,
 -6.0754529, -6.5068208, -16.641632, -26.59048,
 -3.3576824, -4.5938194, -10.740281, -14.85756,
  9.4434861, -5.8541590,  -9.071890, -26.64566,
 -0.2822065, -0.8926541, -16.311751, -25.70714,
 14.7005331,  2.7240618, -16.647395, -27.27427
), ncol=4, byrow=T)


I_0 <- matrix(c(
    1,    2,    3,    4,
    4,    3,    2,    1,
    3,    4,    2,    1,
    2,    4,    3,    1,
    4,    3,    2,    1,
    4,    3,    2,    1,
    3,    4,    1,    2,
    2,    4,    3,    1,
    4,    3,    2,    1,
    3,    4,    2,    1
), ncol=4, byrow=T)


Dsum_0 <- matrix(c(
  0.000000,   0.000000,   0.000000,   0.000000,   0.00000,
 -8.837963, -14.871193, -22.860348, -39.481499, -67.79865,
 -9.041290, -14.329130, -19.353908, -32.965238, -60.69004,
 -9.144724,  -6.713655, -14.966254,  -1.333069, -28.67805,
 -8.381926, -14.016547, -20.506788, -29.740845, -57.93562,
 -9.381463, -15.456916, -21.963737, -38.605369, -65.19585,
 -8.336441, -12.930260, -16.287943, -31.145505, -41.88578,
 -5.329174, -11.183333, -20.255224, -10.811738, -37.45740,
 -4.981715,  -5.263922,  -6.156576, -22.468327, -48.17547,
 -6.993044,  -4.268982,  10.431551,  -6.215844, -33.49011
), ncol=5, byrow=T)


Rsum_0 <- matrix(c(
  0.000000,   0.000000,   0.000000,   0.000000,   0.00000,
 -8.837963, -14.871193, -22.860348, -39.481499, -67.79865,
 -9.041290, -14.066068, -19.353908, -32.965238, -60.69004,
 -9.144724,   4.488461,   6.919530,  -1.333069, -28.67805,
 -8.381926, -14.016547, -20.506788, -29.740845, -57.93562,
 -9.381463, -15.456916, -21.963737, -38.605369, -65.19585,
 -8.336441, -11.694123, -16.287943, -27.028224, -41.88578,
 -5.329174,   4.114312,  -1.739847, -10.811737, -37.45740,
 -4.981715,  -5.263922,  -6.156576, -22.468327, -48.17547,
 -6.993044,   7.707489,  10.431551,  -6.215844, -33.49011
), ncol=5, byrow=T)



p <- ctrp_bab(ind_0, D_0, R_0, I_0, Dsum_0, Rsum_0, k, m, B, T, F, n_max);
p














R_out <- R_ctrp_test(S, D, R, I, alpha, n_max, from_low, first_rem)
C_out <- ctrp_test(S, D, R, I, alpha, n_max, F, T)
C_out

max(abs(R_out$ind_1 - C_out$ind_1))
max(abs(R_out$ind_2 - C_out$ind_2))
max(abs(R_out$Dsum_1 - C_out$Dsum_1))
max(abs(R_out$Dsum_2 - C_out$Dsum_2))
max(abs(R_out$Rsum_1 - C_out$Rsum_1))
max(abs(R_out$Rsum_2 - C_out$Rsum_2))
max(abs(R_out$R - C_out$R))
max(abs(R_out$I - C_out$I))



m_0 <- m
ind <- c(1,2)
a <- gen_nodes_low (c(1,2), g$Dsum, g$Rsum, g$R, g$I, m, g$D, B, m_0)

b <- gen_nodes_low (1, a$Dsum_2,a$Rsum_1, a$R, a$I, m-1, g$D, B, m_0)
length(a$ind_2)




















